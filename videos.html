<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Videos - Messydesk-studios</title>
    <link href="/style.css" rel="stylesheet" type="text/css" media="all">
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
  </head>

<body>
<div id="container"><!--Container -->
<div id="nav-placeholder">

</div>

<script>
$(function(){
  $("#nav-placeholder").load("navigation.html");
});
</script>
<div id="container2">
<div id="sidebar">
</div>
<div id="main">
<div id="window">
<div id="head">
Videos
</div>
<script>
$(function(){
  $("#sidebar").load("navigation2.html");
});
</script>
<div id="uh">

<script>
document.addEventListener("DOMContentLoaded", async () => {
  const container = document.getElementById("scratch-video-thumbs");
  if (!container) return;

  /* =========================
     CONFIG
  ========================= */

  // Blacklist (Scratch IDs or full URLs)
  const excludeList = [
    "1234567890", // Scratch project ID
    "https://www.youtube.com/watch?v=XXXXX"
  ];

  // Overrides + custom positions
  // Keys:
  //  - Scratch: project ID ("123456789")
  //  - YouTube: full URL OR video ID
  const overrides = {
    "945442870": {
      author: "Lucas and Adam",
    },
    "810851398": {
      author: "Lucas and Adam",
    }
  };

  try {
    const response = await fetch("https://messydesk.neocities.org/more");
    if (!response.ok) throw new Error("Failed to fetch directory");
    const html = await response.text();

    const doc = new DOMParser().parseFromString(html, "text/html");
    const headers = Array.from(doc.querySelectorAll("h2"));

    /* =========================
       SCRATCH VIDEOS
    ========================= */

    const videosHeader = headers.find(h => h.textContent.trim() === "Videos");
    let scratchVideos = [];

    if (videosHeader) {
      let node = videosHeader.nextElementSibling;
      while (node && node.tagName !== "H2") {
        node.querySelectorAll('a[href*="scratch.mit.edu/projects/"]').forEach(a => {
          const idMatch = a.href.match(/projects\/(\d+)/);
          if (!idMatch) return;

          const id = idMatch[1];
          if (excludeList.includes(id)) return;

          const override = overrides[id];

          scratchVideos.push({
            url: a.href,
            title: override?.title || a.textContent.trim(),
            thumb:
              override?.thumb ||
              `https://uploads.scratch.mit.edu/projects/thumbnails/${id}.png`,
            author: override?.author || "Lucas Michael",
            position: override?.position
          });
        });
        node = node.nextElementSibling;
      }
    }

    scratchVideos.reverse();

    /* =========================
      YOUTUBE VIDEOS (VIDEOS SECTION ONLY)
    ========================= */
    
    let youtubeVideos = [];
    
    if (videosHeader) {
      let node = videosHeader.nextElementSibling;
      while (node && node.tagName !== "H2") {
        node.querySelectorAll('a[href*="youtube.com/watch"]').forEach(a => {
          if (excludeList.includes(a.href)) return;
    
          const idMatch = a.href.match(/[?&]v=([^&]+)/);
          if (!idMatch) return;
    
          const videoId = idMatch[1];
          const override = overrides[videoId] || overrides[a.href];
    
          youtubeVideos.push({
            url: a.href,
            title: override?.title || a.textContent.trim(),
            thumb:
              override?.thumb ||
              `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`,
            author: override?.author || "Lucas Michael",
            position: override?.position
          });
        });
        node = node.nextElementSibling;
      }
    }
    
    youtubeVideos.reverse();


    /* =========================
       COMBINE (SCRATCH FIRST)
    ========================= */

    const allVideos = [
      ...scratchVideos,
      ...youtubeVideos
    ];

    /* =========================
       RENDER WITH POSITIONS
    ========================= */

    allVideos.forEach(video => {
      let title = video.title;
      if (title.length > 25) title = title.slice(0, 22) + "...";

      const card = document.createElement("div");
      card.className = "video-card";
      card.innerHTML = `
        <a href="${video.url}" target="_blank">
          <img src="${video.thumb}" alt="${title}">
          <p>${title}</p>
        </a>
        <p class="author">${video.author}</p>
      `;

      if (
        typeof video.position === "number" &&
        video.position < container.children.length
      ) {
        container.insertBefore(card, container.children[video.position]);
      } else {
        container.appendChild(card);
      }
    });

  } catch (e) {
    console.error("Failed to load videos:", e);
  }
});
</script>








<div id="videos">
<div id="scratch-video-thumbs"></div>
</div>



</div>

</div>

</div><!-- main -->
</div> <!-- conatiner2 --> 
</div> <!-- conatiner --> 
<style>
#main{
 width: 90%;
}
#uh{
  overflow: auto;
  height: 620px;
}
#two a, #three a, #four a, #five a, #six a{
 color: black;
 background: #e5e5e5;
 background: linear-gradient(180deg, rgb(260, 260, 260) 0%, rgb(226, 226, 226) 12%, rgba(226, 226, 226, 1) 100%);
 border-top: 1px solid black;
}
a{
 color: #003399; 
}
#one a{
 /*background: linear-gradient(180deg,rgba(110, 110, 110, 1) 0%, rgba(54, 53, 53, 1) 100%);*/
 background: linear-gradient(180deg, rgb(40, 40, 40) 0%, rgb(100, 100, 100) 12%, rgba(100, 100, 100, 1) 100%);
 color: white;
}





#videos{
  display: flex;
  margin-left: 5%;
  margin-right: 5%;
  margin-top: 20px;
  margin-bottom: 20px;
}

#scratch-video-thumbs {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
}


.video-card {
  width: 160px;
  padding: 10px;
  background: #f0ecec;
  border: 1px solid #1d1d1d;
  margin: 0px;
}

.video-card img {
  margin-left: auto;
  margin-right: auto;
  display: block;
  margin-bottom: 10px;
  width: 100%;
}

.video-card p{
  font-size: 14px; 
  padding: 0px; 
  margin-top: 3px;
  margin-bottom: 0;
  color: black;
  
  white-space: nowrap;       /* Keep it on one line */
  overflow: hidden;          /* Hide overflowing text */
  text-overflow: ellipsis;   /* Show "..." */
  max-width: 140px; 
}
.video-card a,
.video-card a:visited,
.video-card a:active {
  color: black;
  text-decoration: none;
  font-weight: bold;
}
.video-card a:hover{
 text-decoration: underline; 
 text-decoration-color: black;
}
.author{
    margin: 0;
    font-size: 12px;
}

</style>
</body>
</html>